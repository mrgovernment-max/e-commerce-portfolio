<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Task Dashboard | TaskMaster</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css"
    />
    <link rel="stylesheet" href="tasklog.css" />
  </head>
  <body>
    <header class="header-container">
      <div class="logo">
        <i class="fas fa-tasks"></i><a href="tasklog.html">TaskMaster</a>
      </div>
      <div class="user-info">
        <span class="username"><i class="fas fa-user"></i> Username</span>
        <button
          class="theme-btn"
          onclick="toggleStylesheet()"
          title="Toggle theme"
        >
          <i class="fas fa-moon"></i>
        </button>
        <button class="logout-btn">
          <i class="fas fa-sign-out-alt"></i> Logout
        </button>
      </div>
    </header>

    <main class="dashboard">
      <section class="task-input-section" data-aos="fade-up">
        <h1>Welcome, <span class="username-placeholder">[User]</span>!</h1>
        <p>What do you need to accomplish today?</p>
        <div class="input-container">
          <input type="text" id="new-task" placeholder="Add a new task..." />
          <button class="add-task-btn" onclick="addTask()">
            <i class="fas fa-plus"></i> Add Task
          </button>
        </div>
      </section>

      <section class="stats" data-aos="fade-up">
        <div class="stat-card">
          <div class="stat-value" id="total-tasks">0</div>
          <div class="stat-label">Total Tasks</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="pending-tasks">0</div>
          <div class="stat-label">Pending</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="completed-tasks">0</div>
          <div class="stat-label">Completed</div>
        </div>
      </section>

      <section class="task-section" data-aos="fade-up">
        <h2><i class="fas fa-list-check"></i> Your Tasks</h2>
        <ul id="task-list" class="task-list">
          <!-- Tasks will be added here dynamically -->
        </ul>
        <div id="empty-tasks" class="empty-state">
          <i class="fas fa-clipboard-list"></i>
          <p>No tasks yet. Add a task to get started!</p>
        </div>
      </section>

      <section class="completed-section" data-aos="fade-up">
        <h2><i class="fas fa-check-circle"></i> Completed Tasks</h2>
        <button class="clear-btn" onclick="clearCompleted()">
          <i class="fas fa-trash"></i> Clear Completed Tasks
        </button>
        <ul class="completed-tasks" id="completed-list">
          <!-- Completed tasks will be added here dynamically -->
        </ul>
        <div id="empty-completed" class="empty-state">
          <i class="fas fa-check-double"></i>
          <p>No completed tasks yet. Complete a task to see it here!</p>
        </div>
      </section>
    </main>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
    <script>
      // Initialize AOS (Animate On Scroll)
      AOS.init({
        duration: 800,
        once: true,
      });

      // Theme toggle functionality
      function toggleStylesheet() {
        document.body.classList.toggle("dark-theme");
        const themeBtn = document.querySelector(".theme-btn i");
        if (document.body.classList.contains("dark-theme")) {
          themeBtn.classList.remove("fa-moon");
          themeBtn.classList.add("fa-sun");
        } else {
          themeBtn.classList.remove("fa-sun");
          themeBtn.classList.add("fa-moon");
        }
        // Save theme preference to localStorage
        localStorage.setItem(
          "theme",
          document.body.classList.contains("dark-theme") ? "dark" : "light"
        );
      }

      // Load saved theme preference
      window.addEventListener("DOMContentLoaded", () => {
        const savedTheme = localStorage.getItem("theme");
        if (savedTheme === "dark") {
          document.body.classList.add("dark-theme");
          document.querySelector(".theme-btn i").classList.remove("fa-moon");
          document.querySelector(".theme-btn i").classList.add("fa-sun");
        }

        // Load tasks from localStorage
        loadTasks();
        updateStats();
      });

      // Task management functions
      let tasks = JSON.parse(localStorage.getItem("tasks")) || [];
      let completedTasks =
        JSON.parse(localStorage.getItem("completedTasks")) || [];

      function addTask() {
        const taskInput = document.getElementById("new-task");
        const taskText = taskInput.value.trim();

        if (taskText === "") {
          alert("Please enter a task!");
          return;
        }

        const task = {
          id: Date.now(),
          text: taskText,
          completed: false,
          createdAt: new Date().toISOString(),
        };

        tasks.push(task);
        saveTasks();
        renderTasks();
        taskInput.value = "";
        updateStats();

        // Show empty state if needed
        document.getElementById("empty-tasks").style.display = "none";
      }

      function completeTask(id) {
        const taskIndex = tasks.findIndex((task) => task.id === id);
        if (taskIndex !== -1) {
          const task = tasks[taskIndex];
          task.completed = true;
          task.completedAt = new Date().toISOString();
          completedTasks.push(task);
          tasks.splice(taskIndex, 1);
          saveTasks();
          renderTasks();
          updateStats();

          if (tasks.length === 0) {
            document.getElementById("empty-tasks").style.display = "block";
          }
          if (completedTasks.length > 0) {
            document.getElementById("empty-completed").style.display = "none";
          }
        }
      }

      function deleteTask(id, isCompleted = false) {
        if (isCompleted) {
          completedTasks = completedTasks.filter((task) => task.id !== id);
        } else {
          tasks = tasks.filter((task) => task.id !== id);
        }

        saveTasks();
        renderTasks();
        updateStats();

        if (tasks.length === 0) {
          document.getElementById("empty-tasks").style.display = "block";
        }
        if (completedTasks.length === 0) {
          document.getElementById("empty-completed").style.display = "block";
        }
      }

      function clearCompleted() {
        if (completedTasks.length === 0) {
          alert("No completed tasks to clear!");
          return;
        }

        if (confirm("Are you sure you want to clear all completed tasks?")) {
          completedTasks = [];
          saveTasks();
          renderTasks();
          updateStats();
          document.getElementById("empty-completed").style.display = "block";
        }
      }

      function saveTasks() {
        localStorage.setItem("tasks", JSON.stringify(tasks));
        localStorage.setItem("completedTasks", JSON.stringify(completedTasks));
      }

      function loadTasks() {
        tasks = JSON.parse(localStorage.getItem("tasks")) || [];
        completedTasks =
          JSON.parse(localStorage.getItem("completedTasks")) || [];
        renderTasks();

        // Show/hide empty states
        document.getElementById("empty-tasks").style.display =
          tasks.length === 0 ? "block" : "none";
        document.getElementById("empty-completed").style.display =
          completedTasks.length === 0 ? "block" : "none";
      }

      function renderTasks() {
        const taskList = document.getElementById("task-list");
        const completedList = document.getElementById("completed-list");

        // Clear current lists
        taskList.innerHTML = "";
        completedList.innerHTML = "";

        // Render active tasks
        tasks.forEach((task) => {
          const li = document.createElement("li");
          li.className = "fade-in";
          li.innerHTML = `
            <div class="task-content">
              <div class="task-checkbox" onclick="completeTask(${task.id})"></div>
              <span class="task-text">${task.text}</span>
            </div>
            <div class="task-actions">
              <button class="add-to-complete-button" onclick="completeTask(${task.id})">
                <i class="fas fa-check"></i> Complete
              </button>
              <button class="delete-button" onclick="deleteTask(${task.id})">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          `;
          taskList.appendChild(li);
        });

        // Render completed tasks
        completedTasks.forEach((task) => {
          const li = document.createElement("li");
          li.className = "fade-in";
          li.innerHTML = `
            <div class="task-content">
              <div class="task-checkbox checked" onclick="deleteTask(${task.id}, true)"></div>
              <span class="task-text">${task.text}</span>
            </div>
            <div class="task-actions">
              <button class="delete-button" onclick="deleteTask(${task.id}, true)">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          `;
          completedList.appendChild(li);
        });
      }

      function updateStats() {
        document.getElementById("total-tasks").textContent =
          tasks.length + completedTasks.length;
        document.getElementById("pending-tasks").textContent = tasks.length;
        document.getElementById("completed-tasks").textContent =
          completedTasks.length;
      }

      // Allow adding task with Enter key
      document
        .getElementById("new-task")
        .addEventListener("keypress", function (e) {
          if (e.key === "Enter") {
            addTask();
          }
        });

      // Logout  functionality
      document
        .querySelector(".logout-btn")
        .addEventListener("click", function () {
          if (confirm("Are you sure you want to logout?")) {
            // In a real app, this would redirect to logout endpoint
            alert("Logged out successfully!");
          }
        });
    </script>
  </body>
</html>
