<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Our Shoes</title>
    <link rel="stylesheet" href="styles.css" />
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="app.js"></script>
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />
    <script
      src="https://kit.fontawesome.com/a47fc389f5.js"
      crossorigin="anonymous"
    ></script>
  </head>
  <!-- Google tag (gtag.js) -->
  <script
    async
    src="https://www.googletagmanager.com/gtag/js?id=G-HHT3SEEJE3"
  ></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag("js", new Date());

    gtag("config", "G-HHT3SEEJE3");
  </script>
  <body>
    <header>
      <div id="logo">
        <a href="index.html"> <img src="images/logo.webp" alt="logo" /></a>
      </div>
      <h1>Our Brand Collection</h1>
      <nav>
        <a href="index.html"
          ><i class="fa-solid fa-house" style="color: #74c0fc"></i
        ></a>
        <a href="products.html"
          ><i class="fa-solid fa-bag-shopping" style="color: #74c0fc"></i
        ></a>
        <a href="cart.html">
          <i class="fa-solid fa-cart-shopping" style="color: #74c0fc"></i>
          <sup id="total-cart-items"></sup
        ></a>
        <a href="about-us.html"
          ><i class="fa-solid fa-user" style="color: #74c0fc"></i
        ></a>
      </nav>
    </header>

    <main>
      <!-- Search bar -->
      <div class="search-container" data-aos="flip-down">
        <input
          type="text"
          id="searchInput"
          placeholder="Search for products..."
          onkeyup="filterProducts()"
        />
      </div>

      <div id="add-to-cart-alert">
        <!--alert message of add to cart pops-->
      </div>

      <div class="product-list" id="productContainer">
        <!-- Products will load dynamically from database -->
      </div>
    </main>

    <footer>
      <div class="footer-flex">
        <section class="footer-col">
          <h2>SNEAK X</h2>
          <p>
            This site is a showcase of my skills. Reach out if you'd like a
            custom, personalized one built just for you.
          </p>
          <a
            target="blamk"
            href="https://eur03.safelinks.protection.outlook.com/?url=https%3A%2F%2Fsnapchat.com%2Ft%2FMpSeMetz&data=05%7C02%7C24015084%40activatelearning.ac.uk%7C2a2986c3110e44e9ea5d08dd5c9846b8%7Cd0da4c4cf48e4668886b52b056507a5e%7C0%7C0%7C638768531271459496%7CUnknown%7CTWFpbGZsb3d8eyJFbXB0eU1hcGkiOnRydWUsIlYiOiIwLjAuMDAwMCIsIlAiOiJXaW4zMiIsIkFOIjoiTWFpbCIsIldUIjoyfQ%3D%3D%7C0%7C%7C%7C&sdata=JbQ2GNcei9Zfz8%2FMuZN89OIWOoeQIRpbpNwfmFnHUrM%3D&reserved=0"
            ><i
              class="fa-brands fa-snapchat fa-spin fa-spin-reverse"
              style="color: #74c0fc"
            ></i
          ></a>
          <a target="_blank" href="https://www.instagram.com/_idonmindit/"
            ><i
              class="fa-brands fa-instagram fa-spin"
              style="color: #74c0fc"
            ></i
          ></a>
          <a target="_blank" href=""
            ><i
              class="fa-brands fa-x-twitter fa-spin"
              style="color: #74c0fc"
            ></i
          ></a>
          <p>&copy; 2024 Brand. All rights reserved.</p>
        </section>
        <section id="quick-links" class="footer-col">
          <h2>Quick Links</h2>
          <a href="products.html">Products</a><a href="cart.html">Cart</a
          ><a href="about-us.html">About</a><a href="index.html">Home</a>
        </section>
        <section class="footer-col" id="contact-col">
          <h2>Contact</h2>
          <p>Email: 00000000@0000.com</p>
          <p>Phone: +44 000 0000 000</p>
          <p>Location: placeholder, PH</p>
        </section>
        <section class="footer-col">
          <h2>Stay Updated</h2>
          <form id="newsletter-form">
            <input
              class="sub-in"
              type="email"
              placeholder="Enter your email"
              required
            />
            <button class="sub-btn" type="submit">Subscribe</button>
          </form>
        </section>
      </div>
    </footer>
    <script>
      (async function LoadProductsData() {
        const container = document.getElementById("productContainer");

        // Show loading message first
        container.innerHTML = `<h1 style="color: gray; font-size: 1.5rem;">Loading Products   refresh page... </h1>`;

        try {
          const res = await fetch(
            "https://backendroutes-lcpt.onrender.com/products"
          );
          const products = await res.json();

          // Clear loading message
          container.innerHTML = "";

          products.forEach((product) => {
            const safeName = product.name;
            const sizes = ["Small", "Medium", "Large"];

            const div = document.createElement("div");
            div.className = "product-item";
            div.setAttribute("data-name", product.name);
            div.setAttribute("data-aos", "fade-up");

            div.innerHTML = `
        <img src="${product.img_url}" alt="${product.name}" loading="lazy"
          onclick="productDetails(
            '${product.img_url}',
            '${product.img_url_1}',
            '${product.img_url_2}',
            '${product.img_url_3}',
            ${product.rating || 0},
            '${product.description}',
            '${product.availability}',
            '${product.brand_img_url}',
            '${product.brand_description}',
            '${product.name}',
            ${product.price || 0}
          )" />
        <h3>${product.name}</h3>
        <select class="size-select" id="size-select-${safeName}">
          ${sizes
            .map((size) => `<option value="${size}">${size}</option>`)
            .join("")}
        </select>
        <p>$${product.price}</p>
        <input type="number" id="${safeName}-qty" value="1" min="1" /><br/>
        <button class="add-to-cart-btn"
          onclick="addToCart(
            '${product.name}',
            ${product.price},
            '${product.img_url}',
            document.getElementById('${safeName}-qty').value,
            document.getElementById('size-select-${safeName}').value
          )">
          Add to Cart
        </button>
      `;

            container.appendChild(div);
          });
        } catch (err) {
          console.error("Failed to load products:", err);
          container.innerHTML =
            "<h1 style='color: red;'>Failed to load products.</h1>";
        }
      })();

      document.addEventListener("DOMContentLoaded", function () {
        AOS.init({
          once: false,
          mirror: true,
        });
      });
    </script>
  </body>
</html>
